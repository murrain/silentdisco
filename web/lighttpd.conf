server.document-root = "/srv/http"
server.port = 80

server.modules = (
  "mod_access",
  "mod_accesslog",
  "mod_alias",
  "mod_redirect",
  "mod_setenv",
  "mod_rewrite"
)

index-file.names = ( "index.html", "index.htm" )

mimetype.assign = (
  ".html" => "text/html",
  ".htm"  => "text/html",
  ".css"  => "text/css",
  ".js"   => "application/javascript",
  ".png"  => "image/png",
  ".jpg"  => "image/jpeg",
  ".jpeg" => "image/jpeg",
  ".svg"  => "image/svg+xml",
  ".m3u"  => "audio/x-mpegurl",
  ".xspf" => "application/xspf+xml"
)

accesslog.filename = "/var/log/lighttpd/access.log"

# Root "/" â†’ landing page
url.rewrite-once = ( "^/$" => "/index.html" )

# Media players: if they hit "/", give them the playlist instead
$HTTP["useragent"] =~ "(VLC|mpv|Kodi|MXPlayer|nPlayer|OPlayer|Infuse|BSPlayer)" {
  url.rewrite-once = ( "^/$" => "/stream" )
  index-file.names = ( "stream.m3u" )
}

# Expose the playlist at /stream (friendly URL)
alias.url += ( "/stream" => "/srv/http/stream.m3u" )